function createDatatable(config){return $(`#${config.table_id}`).DataTable(loadDatatableConfig(config))}function loadDatatableConfig(config){var Criteria=$.fn.dataTable.Criteria,buttons;return config.columns.map((function(e){-1!=config.ajax.data.orderable.indexOf(e.name)?Object.assign(e,{orderable:!0}):Object.assign(e,{orderable:!1})})),buttons=[{extend:"pageLength",attr:{title:"Ubah Jumlah data tampil"},dom:{buttonLiner:null}},{attr:{title:"Filter Data"},extend:"searchBuilder",config:{depthLimit:1,columns:config.ajax.data.searchable.map((function(e){return e+":name"})),conditions:{string:{"!=":null,starts:null,"!starts":null,"!contains":null,ends:null,"!ends":null,"!null":null,null:null},num:{null:null,"!=":null,"!between":null,"!null":null,between:null},date:{null:null,"!=":null,"!between":null,"!null":null,between:null},html:{null:null,"=":null,"!=":null,starts:null,"!starts":null,"!contains":null,ends:null,"!ends":null,"!null":null},array:{"=":{init:function(that,fn,preDefined=null,array=!1){let column=that.dom.data.children("option:selected").val(),indexArray=that.s.dt.rows().indexes().toArray(),settings=that.s.dt.settings()[0];that.dom.valueTitle.prop("selected",!0);let el=$("<select/>").addClass(Criteria.classes.value).addClass(Criteria.classes.dropDown).addClass(Criteria.classes.italic).addClass(Criteria.classes.select).append(that.dom.valueTitle).on("change.dtsb",(function(){$(this).removeClass(Criteria.classes.italic),fn(that,this)}));that.c.greyscale&&el.addClass(Criteria.classes.greyscale);let added=[],options=[],addOption=(filt,text)=>{that.s.type.includes("html")&&null!==filt&&"string"==typeof filt&&filt.replace(/(<([^>]+)>)/gi,"");let opt=$("<option>",{type:Array.isArray(filt)?"Array":"String",value:filt}).data("sbv",filt).addClass(that.classes.option).addClass(that.classes.notItalic).html(limitText("string"==typeof text?text.replace(/(<([^>]+)>)/gi,""):text)),val=opt.val();-1===added.indexOf(val)&&(added.push(val),options.push(opt),null!==preDefined&&Array.isArray(preDefined[0])&&(preDefined[0]=preDefined[0].sort().join(",")),null!==preDefined&&opt.val()===preDefined[0]&&(opt.prop("selected",!0),el.removeClass(Criteria.classes.italic),that.dom.valueTitle.removeProp("selected")))};if(config.columns[column].options)config.columns[column].options.forEach((function(val){addOption(val.value,val.text)}));else for(let index of indexArray){let filter=settings.oApi._fnGetCellData(settings,index,column,"string"==typeof that.c.orthogonal?that.c.orthogonal:that.c.orthogonal.search),value={filter:"string"==typeof filter?filter.replace(/[\r\n\u2028]/g," "):filter,index:index,text:settings.oApi._fnGetCellData(settings,index,column,"string"==typeof that.c.orthogonal?that.c.orthogonal:that.c.orthogonal.display)};if("array"===that.s.type&&(value.filter=Array.isArray(value.filter)?value.filter:[value.filter],value.text=Array.isArray(value.text)?value.text:[value.text]),array)for(let i=0;i<value.filter.length;i++)addOption(value.filter[i],value.text[i]);else addOption(value.filter,Array.isArray(value.text)?value.text.join(", "):value.text)}options.sort((a,b)=>"array"===that.s.type||"string"===that.s.type||"html"===that.s.type?a.val()<b.val()?-1:a.val()>b.val()?1:0:"num"===that.s.type||"html-num"===that.s.type?+a.val().replace(/(<([^>]+)>)/gi,"")<+b.val().replace(/(<([^>]+)>)/gi,"")?-1:+a.val().replace(/(<([^>]+)>)/gi,"")>+b.val().replace(/(<([^>]+)>)/gi,"")?1:0:"num-fmt"===that.s.type||"html-num-fmt"===that.s.type?+a.val().replace(/[^0-9.]/g,"")<+b.val().replace(/[^0-9.]/g,"")?-1:+a.val().replace(/[^0-9.]/g,"")>+b.val().replace(/[^0-9.]/g,"")?1:0:void 0);for(let opt of options)el.append(opt);return el}},"!=":null,starts:null,"!starts":null,"!contains":null,contains:null,without:null,ends:null,"!ends":null,"!null":null,null:null}}}}],config.buttons.hasOwnProperty("xlsx")&&buttons.push({extend:"excelHtml5",text:'<span class="bi bi-file-earmark-spreadsheet-fill"></span>',attr:{title:"Export dalam format Excel"}}),config.buttons.hasOwnProperty("add")&&buttons.push({text:'<i class="bi bi-plus-circle"></i>',attr:{title:"Tambah data"},action:function(){window.location.href=config.buttons.add.url}}),config.buttons.hasOwnProperty("delete")&&$(document.body).append('<div class="modal fade" id="delete_modal" tabindex="-1" aria-labelledby="delete_modalLabel" aria-hidden="true">\n        <div class="modal-dialog modal-dialog-centered">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title" id="delete_modalLabel">Konfirmasi Penghapusan Data</h5>\n              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Batalkan"></button>\n            </div>\n            <div class="modal-body">\n              Apakah anda yakin ingin menghapus <span id="delete-records-number"></span> data?\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batalkan</button>\n              <button type="button" id="confirm-delete-records" class="btn btn-danger">Hapus</button>\n            </div>\n          </div>\n        </div>\n      </div>')&&$("#confirm-delete-records").on("click",(function(){$.ajax({type:"POST",url:config.buttons.delete.url,data:window.deletePostData,success:function(response){response>0&&location.reload()},error:function(){location.reload()}})}))&&buttons.push({text:'<i class="bi bi-trash3"></i>',attr:{type:"button",title:"Hapus data"},action:function(){postData={selections:mapSelection(this.rows({selected:!0})[0],this.ajax.json().ids),_method:"DELETE"},Object.assign(postData,config.buttons.delete.postData),postData.selections.length>0&&($("#delete-records-number").html(postData.selections.length),new bootstrap.Modal("#delete_modal",{}).show(),window.deletePostData=postData),document.getElementById("delete_modal").addEventListener("hidden.bs.modal",event=>{delete window.deletePostData&&$("#delete-records-number").html("")})}}),config.buttons.hasOwnProperty("manipulateSelected")&&buttons.push({className:config.buttons.manipulateSelected.className+" ",text:config.buttons.manipulateSelected.text,attr:{type:"button",title:config.buttons.manipulateSelected.title},action:function(){postData={selections:mapSelection(this.rows({selected:!0})[0],this.ajax.json().ids),_method:"PUT"},Object.assign(postData,config.buttons.manipulateSelected.postData),$.ajax({type:"POST",url:config.buttons.manipulateSelected.url,data:postData,success:function(response){location.reload()}})}}),config.buttons.hasOwnProperty("manipulateShown")&&buttons.push({className:config.buttons.manipulateShown.className+" ",text:config.buttons.manipulateShown.text,action:function(){var postData={shown_data:this.ajax.json().ids,request_type:"manipulate-shown"};Object.assign(postData,config.buttons.manipulateShown.postData),$.ajax({type:"POST",url:config.buttons.manipulateShown.url,data:postData,success:function(response){config.buttons.manipulateShown.redirect?window.location.href=JSON.parse(response).url:(response=JSON.parse(response)).reload&&location.reload()}})}}),config.buttons.hasOwnProperty("custom")&&buttons.push({text:config.buttons.custom.text,action:config.buttons.custom.action,className:config.buttons.custom.className+" ",attr:{type:"button",title:config.buttons.custom.title}}),{buttons:{dom:{buttonLiner:{tag:"span"}},buttons:buttons},processing:!0,serverSide:!0,select:!0,order:[[0,"asc"]],dom:"Bfrtip",lengthMenu:[[10,25,50,250],["10 baris","25 baris","50 baris","250 baris"]],language:{url:baseUrl("js/datatables/indonesian.json")},searchDelay:500,scrollX:!0,ajax:config.ajax,columns:config.columns,drawCallback:config.drawCallback}}function mapSelection(selected,all){return selected.map((function(e){return all[e]}))}var postData=()=>{var postData=[];return postData[$("#secureData").attr("name")]=$("#secureData").val(),{...postData}};const limitText=str=>str.length>24?str.substring(0,21)+"...":str;